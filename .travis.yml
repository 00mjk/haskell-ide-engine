sudo: false
addons:
  apt:
    sources:
    - hvr-ghc
    - cassou-emacs
    packages:
    - python-virtualenv
    - libgmp-dev
    - emacs24-nox
cache:
  directories:
  - "$HOME/.stack/"
before_install:
- mkdir -p ~/.local/bin
- export PATH=~/.local/bin:$PATH
- travis_retry curl -L https://www.stackage.org/stack/linux-x86_64 | tar xz --wildcards
  --strip-components=1 -C ~/.local/bin '*/stack'
- chmod a+x ~/.local/bin/stack
- stack --version
install:
- "./travis_long stack +RTS -N2 -RTS setup"
- "./travis_long stack build --only-snapshot"
script:
- "./travis_long ./deploy-docs.sh"
- "./travis_long stack +RTS -N1 -RTS build"
- "./travis_long stack +RTS -N1 -RTS build --test"
- "./travis_long stack exec emacs24 -- -q --batch -L elisp -l elisp/tests/hie-tests.el
  -f ert-run-tests-batch-and-exit"
notifications:
  irc:
    channels:
    - chat.freenode.net#haskell-ide-engine
    on_success: change
    on_failure: change
    use_notice: true
    skip_join: true
    template:
    - "%{commit}: %{message} %{build_url}"
env:
  global:
  - GH_REF: github.com/haskell/haskell-ide-engine.git
  - secure: dfjR0iqvz9jc+Rp1xmLk10RuWiWGLAIV4GUcaZYYBwdekChWHqj8cI4Opzi98zCWJTnElqT1hF3+zuPWnyo1wOREnIx7W01FFALFrnFgIgQB21HS5cq5wmRPawSi1WNodb71WsedB8Wz8RqjNL88ZiQeXh+9LkGgiNSXu0Q+K7VOtFtjsAKFMrmsgPi+cHIggecteT8v+wVCHloz9UjHdJ+LKiJPOvruzuguKQa7I39rkRHKdyUfz6PwIONMLhcBHoZOpqBQk6hdbqd0Dxroz83cnOVYVA9iK4XcIZ9hFubF8V9h1C0LNbmppnOXTCSqeLgwzqujKj4HpNBAr+2A/MJn6UKbM4U2xvOGd47BZlZz4xflZKArcNDR64KPspaPzilIjft7Un7Sza5TzWLBT9PpMkM08mxd51yC5Qmk3+ayi5W80iWgfgwGbbdHp7kaOVNu47CzGZrqYafLZInZ1EWuZfXOTxpNj9IOM1LDses5/ARVcE0p8UQbCTZFQ/goFDwwFlSxghIfwI0jDvPq+BeXi6DE8n4n3QQlLDTItt7dATQ+GdnhfbxBDXwz6dxUgJyQzagX9BdAaXjqWXTJyyiyn6FKb29oROhHbNTaMY9csF9EyoF4RttD4QLaDw87DX3XvtGjgglcEZJU4hFLMy1m7ORlxIHuuzdIp+6DmsI=
